<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SLG竞对数据监测演示DEMO</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="header">
    <span class="logo">SLG竞对数据监测演示DEMO</span>
    <span class="data-time-range" id="dataTimeRange" title="根据 weeks_index 自动更新">数据时间: —</span>
    <span class="local-time" id="localTime">本机时间: --</span>
  </header>

  <nav class="top-nav">
    <a href="#" class="top-nav-link active" data-dim="company">公司维度</a>
    <a href="#" class="top-nav-link" data-dim="product">产品维度</a>
    <a href="#" class="top-nav-link" data-dim="creative">素材维度</a>
    <a href="#" class="top-nav-link" data-dim="combo">组合分析</a>
  </nav>

  <div class="layout">
    <aside class="sidebar">
      <div id="sidebarYears"></div>
    </aside>

    <main class="main">
      <!-- 公司维度：大盘数据 + 详细数据（样式与公司详细信息看板统一） -->
      <div id="panelCompany" class="main-panel">
        <h1 class="main-title" id="mainTitle">请从左侧选择周期</h1>
        <nav class="company-detail-sub-nav" id="companyHomeSubNav">
          <a href="#" class="company-detail-sub-link active" data-tab="overall">大盘数据</a>
          <a href="#" class="company-detail-sub-link" data-tab="detail">详细数据</a>
        </nav>
        <div id="companyHomeMarketWrap">
          <div class="toolbar">
            <label class="search-label">搜索:</label>
            <input type="text" id="searchInput" class="search-input" placeholder="搜索表格内容...">
            <button type="button" class="btn-download" id="btnDownload">下载表格</button>
          </div>
        </div>
        <div id="companyHomeDetailPlaceholder" class="company-home-detail-placeholder" style="display:none;">
          <p class="company-home-detail-prompt">请选择公司</p>
          <p class="product-detail-desc">请在大盘数据表格中点击「公司归属」列的公司名，进入该公司详细信息。</p>
        </div>
      </div>

      <!-- 公司详细信息看板（从公司维度大盘数据点击公司归属进入） -->
      <div id="panelCompanyDetail" class="main-panel" style="display:none;">
        <h1 class="main-title" id="companyDetailTitle">公司详细信息</h1>
        <nav class="company-detail-sub-nav" id="companyDetailSubNav">
          <a href="#" class="company-detail-sub-link" data-tab="market">大盘数据</a>
          <a href="#" class="company-detail-sub-link active" data-tab="detail">详细数据</a>
        </nav>
        <p id="companyDetailDateRange" class="product-detail-date-range">—</p>
        <div class="product-detail-intro">
          <h2 class="product-detail-section-title">公司简介</h2>
          <div class="product-detail-cards">
            <div class="product-detail-card"><span class="product-detail-card-label">公司累计安装</span><span id="companyDetailInstall" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">赛道排名（安装）</span><span id="companyDetailRankInstall" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">公司累计流水</span><span id="companyDetailRevenue" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">赛道排名（流水）</span><span id="companyDetailRankRevenue" class="product-detail-card-value">—</span></div>
          </div>
        </div>
        <div class="product-detail-trend">
          <h2 class="product-detail-section-title">公司产品汇总</h2>
          <p id="companyDetailTableDateRange" class="product-detail-desc">20xx年-xx月-xx日 ~ 20xx年-xx月-xx日</p>
          <div class="company-product-table-wrap">
            <table class="data-table company-product-table">
              <thead><tr><th>产品名</th><th>上线时间</th><th>周安装变动（最新周）</th><th>周流水变动（最新周）</th></tr></thead>
              <tbody id="companyDetailProductBody"></tbody>
            </table>
          </div>
        </div>
        <div class="product-detail-trend">
          <h2 class="product-detail-section-title">公司数据趋势</h2>
          <p class="product-detail-desc">折线图：各周产品按公司聚合的当周周安装；堆叠柱状图：各产品在当周周安装的占额</p>
          <div class="product-detail-trend-charts">
            <div class="product-detail-trend-chart-wrap">
              <p class="product-detail-desc">当周周安装（公司汇总，折线图）</p>
              <div class="product-detail-chart-container"><canvas id="companyDetailLineChart"></canvas></div>
            </div>
            <div class="product-detail-trend-chart-wrap">
              <p class="product-detail-desc">各产品当周周安装占额（堆叠柱状图）</p>
              <div class="product-detail-chart-container"><canvas id="companyDetailStackedBarChart"></canvas></div>
            </div>
          </div>
          <div id="companyDetailTrendLoading" class="product-detail-trend-loading" style="display:none;">加载趋势数据中…</div>
        </div>
        <div class="product-detail-creative">
          <h2 class="product-detail-section-title">公司素材投放</h2>
          <div class="product-detail-creative-row">
            <div class="product-detail-chart-wrap">
              <p class="product-detail-desc">饼图 素材各标签占比</p>
              <div class="product-detail-chart-placeholder">饼图占位</div>
            </div>
            <div class="product-detail-chart-wrap">
              <p class="product-detail-desc">柱状图 素材各标签获量</p>
              <div class="product-detail-chart-placeholder">柱状图占位</div>
            </div>
          </div>
        </div>
      </div>

      <!-- 产品维度：爆量产品地区数据 -->
      <div id="panelProduct" class="main-panel" style="display:none;">
        <h1 class="main-title" id="productTitle">请从左侧选择周期</h1>
        <div class="product-toolbar">
          <label class="product-label">产品选择:</label>
          <select id="productSelect" class="product-select">
            <option value="old">SLG爆量旧产品</option>
            <option value="new">SLG爆量新产品</option>
          </select>
          <label class="product-label">时间段:</label>
          <span id="productPeriod" class="product-period">--</span>
          <label class="search-label">搜索:</label>
          <input type="text" id="productSearchInput" class="search-input" placeholder="搜索表格内容...">
          <button type="button" class="btn-download" id="btnProductDownload">下载表格</button>
        </div>
      </div>

      <!-- 产品详细信息看板（从产品维度点击产品进入） -->
      <div id="panelProductDetail" class="main-panel" style="display:none;">
        <h1 class="main-title" id="productDetailTitle">产品详细信息</h1>
        <nav class="product-detail-sub-nav">
          <a href="#" class="product-detail-sub-link" data-tab="market">大盘数据</a>
          <a href="#" class="product-detail-sub-link active" data-tab="detail">详细数据</a>
        </nav>
        <p id="productDetailDateRange" class="product-detail-date-range">20xx年-xx月-xx日 ~ 20xx年-xx月-xx日</p>
        <div class="product-detail-intro">
          <h2 class="product-detail-section-title">产品简介</h2>
          <div class="product-detail-cards">
            <div class="product-detail-card"><span class="product-detail-card-label">公司归属</span><span id="productDetailCompany" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">新/旧产品</span><span id="productDetailNewOld" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">上线时间</span><span id="productDetailLaunch" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">题材标签</span><span id="productDetailTheme" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">画风标签</span><span id="productDetailStyle" class="product-detail-card-value">—</span></div>
          </div>
        </div>
        <div class="product-detail-metrics">
          <div class="product-detail-metrics-row">
            <div class="product-detail-card"><span class="product-detail-card-label">产品累计安装</span><span id="productDetailInstall" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">赛道排名（安装）</span><span id="productDetailRankInstall" class="product-detail-card-value">—</span></div>
          </div>
          <div class="product-detail-metrics-row">
            <div class="product-detail-card"><span class="product-detail-card-label">产品累计流水</span><span id="productDetailRevenue" class="product-detail-card-value">—</span></div>
            <div class="product-detail-card"><span class="product-detail-card-label">赛道排名（流水）</span><span id="productDetailRankRevenue" class="product-detail-card-value">—</span></div>
          </div>
        </div>
        <div class="product-detail-trend">
          <h2 class="product-detail-section-title">产品数据趋势</h2>
          <p class="product-detail-desc">总时间线（周维度）安装变化和分地区获量情况。折线图（当周周安装）+ 累计叠加柱状图（各市场获量）</p>
          <div class="product-detail-trend-charts">
            <div class="product-detail-trend-chart-wrap">
              <p class="product-detail-desc">当周周安装（折线图）</p>
              <div class="product-detail-chart-container"><canvas id="productDetailLineChart"></canvas></div>
            </div>
            <div class="product-detail-trend-chart-wrap">
              <p class="product-detail-desc">各市场获量（堆叠柱状图）</p>
              <div class="product-detail-chart-container"><canvas id="productDetailStackedBarChart"></canvas></div>
            </div>
          </div>
          <div id="productDetailTrendLoading" class="product-detail-trend-loading" style="display:none;">加载趋势数据中…</div>
        </div>
        <div class="product-detail-creative">
          <h2 class="product-detail-section-title">产品素材投放</h2>
          <div class="product-detail-creative-row">
            <div class="product-detail-chart-wrap">
              <p class="product-detail-desc">饼图 素材各标签占比</p>
              <div id="productDetailPieChart" class="product-detail-chart-placeholder">饼图占位</div>
            </div>
            <div class="product-detail-chart-wrap">
              <p class="product-detail-desc">柱状图 素材各标签获量</p>
              <div id="productDetailBarChart" class="product-detail-chart-placeholder">柱状图占位</div>
            </div>
          </div>
          <div class="product-detail-jump-wrap">
            <button type="button" id="btnProductDetailToCreative" class="btn-download product-detail-jump-btn">跳转详细</button>
          </div>
        </div>
      </div>

      <!-- 素材维度：广告创意与视频 -->
      <div id="panelCreative" class="main-panel" style="display:none;">
        <h1 class="main-title" id="creativeTitle">请从左侧选择周期</h1>
        <p id="creativePeriodHint" class="creative-period-hint" style="display:none;"></p>
        <div class="creative-toolbar">
          <label class="product-label">产品表:</label>
          <select id="creativeProductTable" class="product-select">
            <option value="strategy_old">SLG爆量旧产品</option>
            <option value="strategy_new">SLG爆量新产品</option>
          </select>
          <label class="product-label">产品选择:</label>
          <select id="creativeProductSelect" class="product-select">
            <option value="">-- 请先选择周期与产品表 --</option>
          </select>
          <label class="product-label">地区筛选:</label>
          <select id="creativeRegionFilter" class="product-select">
            <option value="">全部地区</option>
            <option value="亚洲T1">亚洲 T1 市场</option>
            <option value="欧美T1">欧美 T1 市场</option>
            <option value="T2">T2 市场</option>
            <option value="T3">T3 市场</option>
          </select>
          <label class="product-label">持续时间:</label>
          <select id="creativeDurationFilter" class="product-select">
            <option value="">全部</option>
            <option value="under15">15 天以下</option>
            <option value="15-30">15～30 天</option>
            <option value="over30">30 天以上</option>
          </select>
          <label class="product-label">视频比例:</label>
          <select id="creativeRatioFilter" class="product-select">
            <option value="">全部</option>
            <option value="横屏">横屏</option>
            <option value="竖屏">竖屏</option>
          </select>
        </div>
        <div id="creativeProductDataRow" class="creative-product-data-wrap" style="display:none;">
          <table class="creative-product-data-table">
            <thead><tr id="creativeProductDataHead"></tr></thead>
            <tbody><tr id="creativeProductDataBody"></tr></tbody>
          </table>
        </div>
        <div class="toolbar">
          <label class="search-label">搜索:</label>
          <input type="text" id="creativeSearchInput" class="search-input" placeholder="搜索素材...">
          <button type="button" class="btn-download" id="btnCreativeDownload">下载表格</button>
        </div>
      </div>

      <!-- 组合分析：每周趋势（静态展示） -->
      <div id="panelCombo" class="main-panel" style="display:none;">
        <h1 class="main-title" id="comboTitle">请从左侧选择周期</h1>
        <div id="comboDeveloping" class="combo-developing" style="display:none;">功能开发中</div>
        <div class="combo-toolbar">
          <label class="product-label">素材关键词占比/获量:</label>
          <select id="comboMetricSelect" class="product-select">
            <option value="share">占比</option>
            <option value="acquisition">获量</option>
          </select>
          <label class="product-label">时间段:</label>
          <span id="comboPeriod" class="product-period">--</span>
        </div>
        <div class="combo-charts">
          <div class="combo-card">
            <h2 class="combo-card-title">素材关键词占比</h2>
            <div class="combo-pie-wrap">
              <div class="combo-pie" title="数字门跑酷 36% / 塔防 28% / 肉鸽/幸存者/割草 22% / 其他 14%"></div>
            </div>
            <div class="combo-legend">
              <span class="combo-legend-item"><i class="combo-legend-dot" style="background:#e67e22"></i>数字门跑酷</span>
              <span class="combo-legend-item"><i class="combo-legend-dot" style="background:#1abc9c"></i>塔防</span>
              <span class="combo-legend-item"><i class="combo-legend-dot" style="background:#2980b9"></i>肉鸽/幸存者/割草</span>
              <span class="combo-legend-item"><i class="combo-legend-dot" style="background:#7fd857"></i>其他</span>
            </div>
          </div>
          <div class="combo-card">
            <h2 class="combo-card-title">素材关键词获量情况</h2>
            <div class="combo-bar-wrap">
              <div class="combo-bar-yaxis">
                <span>14.0万</span><span>12万</span><span>10万</span><span>8万</span><span>6万</span><span>4万</span><span>2万</span><span>0</span>
              </div>
              <div class="combo-bar-chart">
                <div class="combo-bar-col">
                  <div class="combo-bar-item-wrap">
                    <div class="combo-bar-item" style="height:89.3%;background:#e67e22" title="12.5万"></div>
                  </div>
                  <span class="combo-bar-label">数字门跑酷</span>
                </div>
                <div class="combo-bar-col">
                  <div class="combo-bar-item-wrap">
                    <div class="combo-bar-item" style="height:69.3%;background:#1abc9c" title="9.7万"></div>
                  </div>
                  <span class="combo-bar-label">塔防</span>
                </div>
                <div class="combo-bar-col">
                  <div class="combo-bar-item-wrap">
                    <div class="combo-bar-item" style="height:53.6%;background:#2980b9" title="7.5万"></div>
                  </div>
                  <span class="combo-bar-label">肉鸽/幸存者/割草</span>
                </div>
                <div class="combo-bar-col">
                  <div class="combo-bar-item-wrap">
                    <div class="combo-bar-item" style="height:35.7%;background:#7fd857" title="5.0万"></div>
                  </div>
                  <span class="combo-bar-label">其他</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="table-wrap" id="tableWrap">
        <table class="data-table" id="dataTable">
          <thead id="tableHead"></thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
      <div id="loading" class="loading">加载中…</div>
      <div id="empty" class="empty">请从左侧选择年份与周</div>
      <div id="error" class="error" style="display:none;"></div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
