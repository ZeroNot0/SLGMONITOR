# 重构后的文件结构（提案）

本结构以“代码与数据分离、入口清晰、模块化”为目标，同时保留兼容入口（可选软链接或薄包装）。

---

## 一、目标目录结构（顶层）

```
SLG Monitor 3.0/
├─ app/                      # 应用入口与桌面壳
│  ├─ app_launcher.py
│  └─ app_paths.py
│
├─ server/                   # 本地服务端
│  ├─ start_server.py
│  ├─ handlers/              # 路由与请求处理
│  ├─ auth/                  # 登录与权限
│  └─ utils/                 # 服务端工具
│
├─ pipeline/                 # 数据流水线
│  ├─ run_full_pipeline.py
│  ├─ schedule_update.py
│  └─ steps/                 # step1..step5 细分脚本
│
├─ frontend/                 # 前端静态资源
│  ├─ index.html
│  ├─ css/
│  ├─ js/
│  └─ data/                  # 前端 JSON（生成物）
│
├─ data/                     # 业务数据（本地生成/存放）
│  ├─ raw_csv/
│  ├─ intermediate/
│  ├─ output/
│  ├─ target/
│  ├─ final_join/
│  ├─ advertisements/
│  └─ request/
│
├─ mapping/                  # 映射表（产品归属、公司归属、T 度、系数）
├─ labels/                   # 标签底表
├─ newproducts/              # 新游表
├─ backend/                  # 数据库与迁移（MySQL 可选）
│  └─ db/
│
├─ request/                  # API 拉取脚本
│  ├─ api_request.py
│  ├─ fetch_country_data.py
│  └─ fetch_ad_creatives.py
│
├─ scripts/                  # 工具脚本（保留，逐步迁移到 pipeline/）
├─ deploy/                   # 部署与运维脚本
├─ docs/                     # 文档
├─ requirements.txt
└─ build_exe.ps1
```

---

## 二、迁移说明

### 1) 代码迁移

- `start_server.py` -> `server/start_server.py`
- `run_full_pipeline.py` -> `pipeline/run_full_pipeline.py`
- `schedule_update.py` -> `pipeline/schedule_update.py`
- `scripts/step*.py` -> `pipeline/steps/`

### 2) 数据迁移

- `raw_csv/` -> `data/raw_csv/`
- `intermediate/` -> `data/intermediate/`
- `output/` -> `data/output/`
- `target/` -> `data/target/`
- `final_join/` -> `data/final_join/`
- `advertisements/` -> `data/advertisements/`
- `request/country_data/` -> `data/request/country_data/`

### 3) 兼容策略（可选）

- 根目录保留同名入口脚本作为薄包装（import 新路径并转发）。
- 旧数据目录可通过软链接或配置映射到 `data/` 下。

---

## 三、调整重点

- 运行入口集中到 `app/` 与 `pipeline/`
- 服务端逻辑集中到 `server/`
- 业务数据统一归档到 `data/`
- 原有工具脚本保留，但逐步迁移至对应模块

---

## 四、下一步建议

1. 先迁移“入口与服务端”并保持兼容入口。
2. 再迁移“流水线脚本”与数据路径。
3. 最后清理旧目录与重复文件。
